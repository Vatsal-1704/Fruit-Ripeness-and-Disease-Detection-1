

<!DOCTYPE html>
<html>
<head>
    <title>Fruit Analysis Results</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .result-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .image-container {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .analysis-container {
            flex: 1.5;
            min-width: 300px;
        }
        .ripeness-meter {
            width: 100%;
            height: 24px;
            background-color: #e0e0e0;
            border-radius: 12px;
            margin: 15px 0;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }
        .ripeness-fill {
            height: 100%;
            background: linear-gradient(to right, #8BC34A, #CDDC39, #FFC107, #FF5722);
            border-radius: 12px;
            transition: width 0.5s ease-in-out;
        }
        .result-item {
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .result-item h3 {
            margin-top: 0;
            color: #2E7D32;
            border-bottom: 2px solid #E8F5E9;
            padding-bottom: 8px;
        }
        .storage-tips {
            margin-top: 15px;
        }
        .storage-tips ul, .disease-info ul {
            padding-left: 20px;
        }
        .storage-tips li, .disease-info li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        .btn {
            display: inline-block;
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #43A047;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-weight: 600;
            transition: background-color 0.3s;
            border: none;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #2E7D32;
        }
        .btn-secondary {
            background-color: #78909C;
        }
        .btn-secondary:hover {
            background-color: #546E7A;
        }
        .disease-info {
            margin-top: 15px;
        }
        .disease-info-section {
            margin-bottom: 15px;
        }
        .disease-info-section h4 {
            margin-bottom: 5px;
            color: #455A64;
        }
        .disease-info-section p {
            margin-top: 5px;
            line-height: 1.5;
        }
        .ripeness-status {
            font-weight: bold;
            font-size: 1.1em;
        }
        .status-unripe {
            color: #8BC34A;
        }
        .status-partial {
            color: #FFC107;
        }
        .status-ripe {
            color: #FF9800;
        }
        .status-overripe {
            color: #F44336;
        }
        .page-title {
            text-align: center;
            color: #2E7D32;
            margin-bottom: 30px;
        }
        .nutrition-item {
            margin-bottom: 10px;
            padding: 8px 12px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border-left: 3px solid #43A047;
        }
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .alert-success {
            background-color: #E8F5E9;
            border-left: 4px solid #4CAF50;
            color: #2E7D32;
        }
        .alert-warning {
            background-color: #FFF8E1;
            border-left: 4px solid #FFC107;
            color: #FF6F00;
        }
        .alert-info {
            background-color: #E1F5FE;
            border-left: 4px solid #03A9F4;
            color: #0277BD;
        }
    </style>
</head>
<body>
    <h1 class="page-title">Fruit Analysis Results</h1>
    
    <div class="result-container">
        <div class="image-container">
            <h3>Uploaded {{ fruit|capitalize }} Image</h3>
            <img src="data:image/jpeg;base64,{{ img_str }}" style="max-width: 100%; border-radius: 8px;" alt="Uploaded {{ fruit }}">
        </div>
        
        <div class="analysis-container">
            <!-- Disease Detection Results -->
            <div class="result-item">
                <h3>Disease Analysis Results</h3>
                {% if disease_results %}
                    {% for result in disease_results %}
                        <div class="alert {% if result.name == 'healthy' %}alert-success{% else %}alert-warning{% endif %}">
                            <h5>{{ result.name|replace('_', ' ')|title }}</h5>
                            <p>Confidence: {{ "%.2f"|format(result.confidence * 100) }}%</p>
                            
                            <!-- Disease Information Display -->
                            {% if result.info %}
                                <div class="disease-info mt-3">
                                    <div class="disease-info-section">
                                        <h4>About this condition:</h4>
                                        <p><strong style="color: #2E7D32;">Disease Detected:</strong> {{ result.name }}</p>
                                        <!-- <p>{{ result.info.description }}</p> -->
                                    </div>
                                    
                                    {% if result.name != 'healthy' %}
                                        <div class="disease-info-section">
                                            <h4>Recommended Treatment:</h4>
                                            <p>{{ result.info.treatment }}</p>
                                        </div>
                                        
                                        <div class="disease-info-section">
                                            <h4>Prevention:</h4>
                                            <p>{{ result.info.prevention }}</p>
                                        </div>
                                    {% endif %}
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                {% elif class_names %}
                    <p>Detected: <strong>{{ class_names[0] }}</strong></p>
                    
                    <!-- Alternative Disease Info Section -->
                    {% set fruit_lower = fruit|lower %}
                    {% set disease_key = class_names[0]|lower|replace(' ', '_') %}
                    
                    {% if fruit_lower in disease_info and disease_key in disease_info[fruit_lower] %}
                    <div class="disease-info">
                        <div class="disease-info-section">
                            <h4>Description:</h4>
                            <p>{{ disease_info[fruit_lower][disease_key]['description'] }}</p>
                        </div>
                        
                        <div class="disease-info-section">
                            <h4>Treatment:</h4>
                            <p>{{ disease_info[fruit_lower][disease_key]['treatment'] }}</p>
                        </div>
                        
                        <div class="disease-info-section">
                            <h4>Prevention:</h4>
                            <p>{{ disease_info[fruit_lower][disease_key]['prevention'] }}</p>
                        </div>
                    </div>
                    {% else %}
                    <p>No detailed information available for this condition.</p>
                    {% endif %}
                {% else %}
                    <div class="alert alert-info">No disease analysis available.</div>
                {% endif %}
            </div>
            
            <!-- Ripeness Results -->
            <div class="result-item">
                <h3>Ripeness Analysis</h3>
                <div class="ripeness-meter">
                    <div class="ripeness-fill" style="width: {{ ripeness }}%;"></div>
                </div>
                <p><strong>{{ ripeness|round(1) }}%</strong> ripe</p>
                
                {% if ripeness < 40 %}
                <p>Status: <span class="ripeness-status status-unripe">Unripe</span> - Wait a few more days before consuming.</p>
                {% elif ripeness < 70 %}
                <p>Status: <span class="ripeness-status status-partial">Partially Ripe</span> - Will be fully ripe soon.</p>
                {% elif ripeness < 90 %}
                <p>Status: <span class="ripeness-status status-ripe">Ripe</span> - Optimal for consumption.</p>
                {% else %}
                <p>Status: <span class="ripeness-status status-overripe">Very Ripe</span> - Consume soon.</p>
                {% endif %}
            </div>
            
            <!-- Storage Recommendations -->
            <div class="result-item">
                <h3>Storage Recommendations</h3>
                <div class="storage-tips">
                    <ul>
                        {% for tip in storage_recommendations %}
                        <li>{{ tip }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            
            <!-- Nutrition Information -->
            <div class="result-item">
                <h3>Nutrition Information</h3>
                {% if nutrition %}
                    {% for key, value in nutrition.items() %}
                        {% if key != 'benefits' %}
                            <div class="nutrition-item">
                                <strong>{{ key|replace('_', ' ')|title }}:</strong> {{ value }}
                            </div>
                        {% endif %}
                    {% endfor %}
                    
                    {% if nutrition.benefits %}
                        <div class="alert alert-info">
                            <strong>Benefits:</strong> {{ nutrition.benefits }}
                        </div>
                    {% endif %}
                {% else %}
                    <a href="/nutrition/{{ fruit }}" class="btn">View Nutrition Information</a>
                {% endif %}
            </div>
            
            <!-- Navigation Buttons -->
            <div class="result-item">
                <a href="/{{ fruit }}_detection" class="btn">
                    Upload Another {{ fruit|capitalize }}
                </a>
                <a href="/disease_detection" class="btn btn-secondary">Back to Detection</a>
                <a href="/" class="btn btn-secondary">Back to Home</a>
            </div>
        </div>
    </div>
</body>
</html>
